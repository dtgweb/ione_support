,items: [
  <%= f.text_field :subject %>
  ,<%= f.collection_select :ownerstaffid, SupportStaff.all, :staffid, :username, :field_label => "Owner", :value => current_user.support_staff ? current_user.support_staff.staffid : current_object.ownerstaffid %>
  ,<%= f.select :eventtype, ["public", "private"], :field_label => "Event Type" %>
  ,<%= f.select :activitytype, {"call" => 1, "appointment" => 0}, :field_label => "Activity Type" %>
  ,<%= f.select :calendarstatusid, SupportCalendarStatus.events.collect{|status| [status.title, status.calendarstatusid]} << [" - None - ", 0], :field_label => "Status" %>
  ,<%= f.select :calendarcategoryid, SupportCalendarCategory.events.collect{|category| [category.title, category.calendarcategoryid]} << [" - None - ", 0], :field_label => "Category" %>
  ,<%= f.text_field :location %>
  ,{
    xtype:'xdatetime'
    ,fieldLabel:'Start'
    ,hiddenName: 'support_calendar_event[start_at]'
    ,timeFormat:'g:i A T'
    ,hiddenFormat:'Y-m-d H:i:s O'
    ,timeConfig: {
      allowBlank:false    
    }
    ,dateConfig: {
      allowBlank:false
    }
    ,value: <%= current_object.start_at.andand.strftime('"%Y-%m-%d %H:%M:%S %z"') || Time.now.end_of_day.advance(:hours => 12, :seconds => 1).strftime('"%Y-%m-%d %H:%M:%S %z"') %>
  }
  ,{
    xtype:'xdatetime'
    ,fieldLabel:'End'
    ,hiddenName: 'support_calendar_event[end_at]'
    ,timeFormat:'g:i A T'
    ,hiddenFormat:'Y-m-d H:i:s O'
    ,timeConfig: {
      allowBlank:true    
    }
    ,dateConfig: {
      allowBlank:true
    }
    <%= ",value: #{current_object.end_at.strftime('"%Y-%m-%d %H:%M:%S %z"')}" if current_object.end_at %>
  }
  ,<%= f.select :calendarlabelid, SupportCalendarLabel.events.collect{|label| [label.title, label.calendarlabelid]} << [" - None - ", 0], :field_label => "Label" %>
]
,buttons: [
  <%= f.submit "Save", :wait_msg => "Saving Event...", :on_success => "Ext.WindowMgr.getActive().close(); Ext.ux.Toast.msg('', 'Saved');" %>
  ,<%= f.submit "Cancel", :handler => "Ext.WindowMgr.getActive().close();" %>
]